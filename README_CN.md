[toc]

# protoc-gen-bean

English version README [here](./README.md)

Java Value Object Generator Plugin For Protobuf

## 安装要求

首先安装 protoc 编译工具

你可以在这里找到

[Github](https://github.com/google/protobuf)

或是从官网上下载

[Google](https://developers.google.com/protocol-buffers/)

## 安装

### Homebrew

```shell
brew tap master-g/tap
brew install master-g/tap/protoc-gen-bean
```

### 手动

你可以克隆本代码仓库自行构建，或是移步 [release](https://github.com/master-g/protoc-gen-bean/releases) 页面下载预先编译好的二进制文件

## 使用

```shell
protoc --plugin=protoc-gen-bean --bean_out=. *.proto
```

如果你是通过 homebrew 安装的，或是将 `protoc-gen-bean` 添加到了你的环境变量中(env PATH)，则：

```shell
protoc --plugin=bean --bean_out=. *.proto
```

### 参数

为了向插件传递额外的参数，使用 `,` 来分离它们：

```shell
protoc --plugin=protoc-gen-bean --bean_out=vopkg=vo,notime=false,flavor=kotlin:. *.proto
```

* `vopkg=xxx` - Value Object 的包名
* `notime=true|false` - 是否禁止在生成文件的头部添加时间戳信息, 默认为生成 (false)
* `flavor=kotlin|java` - 生成代码的风味, 默认为 kotlin (我们可能会停止维护 java 输出)

假设有 proto 文件 `test.proto` 内容如下：

```proto
syntax = "proto3";
package proto.common;
option java_package = "com.acme.model.protobuf";
option java_outer_classname = "PbCommon";

message Hello {
  string msg = 1;
  int32 code = 2;
}
```

生成的例子代码如下

**Java Value Object**

```kotlin
package com.acme.model.vo.proto.common

// Code generated by protoc-gen-bean. DO NOT EDIT.
// 2021-12-08 Wed 17:15:25 UTC+0800
//
//     test.proto
//


class Hello {
    var msg: String = ""
    var code: Int = 0

    override fun toString(): String {
        return "Hello{" +
                "msg='" + msg + '\'' +
                ", code=" + code +
                "}"
    }
}
```

**输出结构**

```
.
└── com
    └── acme
        └── model
            └── vo
                └── common
                    └── Hello.java
```
